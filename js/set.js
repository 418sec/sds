(function() {
  /*
   0000000  00000000  000000000
  000       000          000   
  0000000   0000000      000   
       000  000          000   
  0000000   00000000     000   
  */
  /*
   * accepts an object, a keypath as an array or string and a value
   * returns the object with value set at keypath
   */
  var _, set;

  ({_} = require('kxk'));

  set = function(object, keypath, value) {
    var k, kp, o;
    if (_.isString(keypath)) {
      keypath = keypath.split('.');
    }
    if (!_.isArray(keypath)) {
      throw `invalid keypath: ${JSON.stringify(keypath)}`;
    }
    kp = _.clone(keypath);
    o = object;
    while (kp.length > 1) {
      k = kp.shift();
      if (o[k] == null) {
        if (!_.isNaN(_.parseInt(k))) {
          o = o[k] = [];
        } else {
          o = o[k] = {};
        }
      } else {
        o = o[k];
      }
    }
    if (kp.length === 1 && (o != null)) {
      o[kp[0]] = value;
      if (o[kp[0]] !== value) {
        throw `couldn't set value ${JSON.stringify(value)} for keypath ${keypath.join('.')} in ${JSON.stringify(object)}`;
      }
    }
    return object;
  };

  module.exports = set;

}).call(this);

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2V0LmpzIiwic291cmNlUm9vdCI6Ii4uIiwic291cmNlcyI6WyJqcy9zZXQuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7RUFBQTs7Ozs7Ozs7Ozs7QUFBQSxNQUFBLENBQUEsRUFBQTs7RUFRQSxDQUFBLENBQUUsQ0FBRixDQUFBLEdBQVEsT0FBQSxDQUFRLEtBQVIsQ0FBUjs7RUFPQSxHQUFBLEdBQU0sUUFBQSxDQUFDLE1BQUQsRUFBUyxPQUFULEVBQWtCLEtBQWxCLENBQUE7QUFDRixRQUFBLENBQUEsRUFBQSxFQUFBLEVBQUE7SUFBQSxJQUErQixDQUFDLENBQUMsUUFBRixDQUFXLE9BQVgsQ0FBL0I7TUFBQSxPQUFBLEdBQVUsT0FBTyxDQUFDLEtBQVIsQ0FBYyxHQUFkLEVBQVY7O0lBQ0EsSUFBc0QsQ0FBSSxDQUFDLENBQUMsT0FBRixDQUFVLE9BQVYsQ0FBMUQ7TUFBQSxNQUFNLENBQUEsaUJBQUEsQ0FBQSxDQUFvQixJQUFJLENBQUMsU0FBTCxDQUFlLE9BQWYsQ0FBcEIsQ0FBQSxFQUFOOztJQUNBLEVBQUEsR0FBSyxDQUFDLENBQUMsS0FBRixDQUFRLE9BQVI7SUFDTCxDQUFBLEdBQUk7QUFDSixXQUFNLEVBQUUsQ0FBQyxNQUFILEdBQVksQ0FBbEI7TUFDSSxDQUFBLEdBQUksRUFBRSxDQUFDLEtBQUgsQ0FBQTtNQUNKLElBQU8sWUFBUDtRQUNJLElBQUcsQ0FBSSxDQUFDLENBQUMsS0FBRixDQUFRLENBQUMsQ0FBQyxRQUFGLENBQVcsQ0FBWCxDQUFSLENBQVA7VUFDSSxDQUFBLEdBQUksQ0FBRSxDQUFBLENBQUEsQ0FBRixHQUFPLEdBRGY7U0FBQSxNQUFBO1VBR0ksQ0FBQSxHQUFJLENBQUUsQ0FBQSxDQUFBLENBQUYsR0FBTyxDQUFBLEVBSGY7U0FESjtPQUFBLE1BQUE7UUFNSSxDQUFBLEdBQUksQ0FBRSxDQUFBLENBQUEsRUFOVjs7SUFGSjtJQVVBLElBQUcsRUFBRSxDQUFDLE1BQUgsS0FBYSxDQUFiLElBQW1CLFdBQXRCO01BQ0ksQ0FBRSxDQUFBLEVBQUcsQ0FBQSxDQUFBLENBQUgsQ0FBRixHQUFXO01BQ1gsSUFBRyxDQUFFLENBQUEsRUFBRyxDQUFBLENBQUEsQ0FBSCxDQUFGLEtBQVksS0FBZjtRQUNJLE1BQU0sQ0FBQSxtQkFBQSxDQUFBLENBQXNCLElBQUksQ0FBQyxTQUFMLENBQWUsS0FBZixDQUF0QixDQUEyQyxhQUEzQyxDQUFBLENBQTBELE9BQU8sQ0FBQyxJQUFSLENBQWEsR0FBYixDQUExRCxDQUEyRSxJQUEzRSxDQUFBLENBQWlGLElBQUksQ0FBQyxTQUFMLENBQWUsTUFBZixDQUFqRixDQUFBLEVBRFY7T0FGSjs7V0FJQTtFQW5CRTs7RUFxQk4sTUFBTSxDQUFDLE9BQVAsR0FBaUI7QUFwQ2pCIiwic291cmNlc0NvbnRlbnQiOlsiIyMjXG4gMDAwMDAwMCAgMDAwMDAwMDAgIDAwMDAwMDAwMFxuMDAwICAgICAgIDAwMCAgICAgICAgICAwMDAgICBcbjAwMDAwMDAgICAwMDAwMDAwICAgICAgMDAwICAgXG4gICAgIDAwMCAgMDAwICAgICAgICAgIDAwMCAgIFxuMDAwMDAwMCAgIDAwMDAwMDAwICAgICAwMDAgICBcbiMjI1xuXG57IF8gfSA9IHJlcXVpcmUgJ2t4aydcblxuIyMjXG4jIGFjY2VwdHMgYW4gb2JqZWN0LCBhIGtleXBhdGggYXMgYW4gYXJyYXkgb3Igc3RyaW5nIGFuZCBhIHZhbHVlXG4jIHJldHVybnMgdGhlIG9iamVjdCB3aXRoIHZhbHVlIHNldCBhdCBrZXlwYXRoXG4jIyNcblxuc2V0ID0gKG9iamVjdCwga2V5cGF0aCwgdmFsdWUpIC0+XG4gICAga2V5cGF0aCA9IGtleXBhdGguc3BsaXQgJy4nIGlmIF8uaXNTdHJpbmcga2V5cGF0aFxuICAgIHRocm93IFwiaW52YWxpZCBrZXlwYXRoOiAje0pTT04uc3RyaW5naWZ5IGtleXBhdGh9XCIgaWYgbm90IF8uaXNBcnJheSBrZXlwYXRoXG4gICAga3AgPSBfLmNsb25lIGtleXBhdGhcbiAgICBvID0gb2JqZWN0XG4gICAgd2hpbGUga3AubGVuZ3RoID4gMVxuICAgICAgICBrID0ga3Auc2hpZnQoKVxuICAgICAgICBpZiBub3Qgb1trXT9cbiAgICAgICAgICAgIGlmIG5vdCBfLmlzTmFOIF8ucGFyc2VJbnQga1xuICAgICAgICAgICAgICAgIG8gPSBvW2tdID0gW11cbiAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICBvID0gb1trXSA9IHt9XG4gICAgICAgIGVsc2VcbiAgICAgICAgICAgIG8gPSBvW2tdXG4gICAgICAgICAgICBcbiAgICBpZiBrcC5sZW5ndGggPT0gMSBhbmQgbz9cbiAgICAgICAgb1trcFswXV0gPSB2YWx1ZVxuICAgICAgICBpZiBvW2twWzBdXSAhPSB2YWx1ZVxuICAgICAgICAgICAgdGhyb3cgXCJjb3VsZG4ndCBzZXQgdmFsdWUgI3tKU09OLnN0cmluZ2lmeSB2YWx1ZX0gZm9yIGtleXBhdGggI3trZXlwYXRoLmpvaW4gJy4nfSBpbiAje0pTT04uc3RyaW5naWZ5IG9iamVjdH1cIlxuICAgIG9iamVjdFxuXG5tb2R1bGUuZXhwb3J0cyA9IHNldFxuIl19
//# sourceURL=C:/Users/kodi/s/sds/coffee/set.coffee