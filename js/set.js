(function() {
  /*
   0000000  00000000  000000000
  000       000          000   
  0000000   0000000      000   
       000  000          000   
  0000000   00000000     000   
  */
  /*
   * accepts an object, a keypath as an array or string and a value
   * returns the object with value set at keypath
   */
  var _, set;

  _ = require('lodash');

  set = function(object, keypath, value) {
    var k, kp, o;
    if (_.isString(keypath)) {
      keypath = keypath.split('.');
    }
    if (!_.isArray(keypath)) {
      throw `invalid keypath: ${JSON.stringify(keypath)}`;
    }
    kp = _.clone(keypath);
    o = object;
    while (kp.length > 1) {
      k = kp.shift();
      if (o[k] == null) {
        if (!_.isNaN(_.parseInt(k))) {
          o = o[k] = [];
        } else {
          o = o[k] = {};
        }
      } else {
        o = o[k];
      }
    }
    if (kp.length === 1 && (o != null)) {
      if (value === void 0) {
        delete o[kp[0]];
      } else {
        o[kp[0]] = value;
        if (o[kp[0]] !== value) {
          throw `couldn't set value ${JSON.stringify(value)} for keypath ${keypath.join('.')} in ${JSON.stringify(object)}`;
        }
      }
    }
    return object;
  };

  module.exports = set;

}).call(this);

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2V0LmpzIiwic291cmNlUm9vdCI6Ii4uIiwic291cmNlcyI6WyJjb2ZmZWUvc2V0LmNvZmZlZSJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtFQUFBOzs7Ozs7Ozs7OztBQUFBLE1BQUEsQ0FBQSxFQUFBOztFQVFBLENBQUEsR0FBSSxPQUFBLENBQVEsUUFBUjs7RUFPSixHQUFBLEdBQU0sUUFBQSxDQUFDLE1BQUQsRUFBUyxPQUFULEVBQWtCLEtBQWxCLENBQUE7QUFFRixRQUFBLENBQUEsRUFBQSxFQUFBLEVBQUE7SUFBQSxJQUErQixDQUFDLENBQUMsUUFBRixDQUFXLE9BQVgsQ0FBL0I7TUFBQSxPQUFBLEdBQVUsT0FBTyxDQUFDLEtBQVIsQ0FBYyxHQUFkLEVBQVY7O0lBQ0EsSUFBc0QsQ0FBSSxDQUFDLENBQUMsT0FBRixDQUFVLE9BQVYsQ0FBMUQ7TUFBQSxNQUFNLENBQUEsaUJBQUEsQ0FBQSxDQUFvQixJQUFJLENBQUMsU0FBTCxDQUFlLE9BQWYsQ0FBcEIsQ0FBQSxFQUFOOztJQUVBLEVBQUEsR0FBSyxDQUFDLENBQUMsS0FBRixDQUFRLE9BQVI7SUFDTCxDQUFBLEdBQUk7QUFFSixXQUFNLEVBQUUsQ0FBQyxNQUFILEdBQVksQ0FBbEI7TUFDSSxDQUFBLEdBQUksRUFBRSxDQUFDLEtBQUgsQ0FBQTtNQUNKLElBQU8sWUFBUDtRQUNJLElBQUcsQ0FBSSxDQUFDLENBQUMsS0FBRixDQUFRLENBQUMsQ0FBQyxRQUFGLENBQVcsQ0FBWCxDQUFSLENBQVA7VUFDSSxDQUFBLEdBQUksQ0FBRSxDQUFBLENBQUEsQ0FBRixHQUFPLEdBRGY7U0FBQSxNQUFBO1VBR0ksQ0FBQSxHQUFJLENBQUUsQ0FBQSxDQUFBLENBQUYsR0FBTyxDQUFBLEVBSGY7U0FESjtPQUFBLE1BQUE7UUFNSSxDQUFBLEdBQUksQ0FBRSxDQUFBLENBQUEsRUFOVjs7SUFGSjtJQVVBLElBQUcsRUFBRSxDQUFDLE1BQUgsS0FBYSxDQUFiLElBQW1CLFdBQXRCO01BQ0ksSUFBRyxLQUFBLEtBQVMsTUFBWjtRQUNJLE9BQU8sQ0FBRSxDQUFBLEVBQUcsQ0FBQSxDQUFBLENBQUgsRUFEYjtPQUFBLE1BQUE7UUFHSSxDQUFFLENBQUEsRUFBRyxDQUFBLENBQUEsQ0FBSCxDQUFGLEdBQVc7UUFDWCxJQUFHLENBQUUsQ0FBQSxFQUFHLENBQUEsQ0FBQSxDQUFILENBQUYsS0FBWSxLQUFmO1VBQ0ksTUFBTSxDQUFBLG1CQUFBLENBQUEsQ0FBc0IsSUFBSSxDQUFDLFNBQUwsQ0FBZSxLQUFmLENBQXRCLENBQTJDLGFBQTNDLENBQUEsQ0FBMEQsT0FBTyxDQUFDLElBQVIsQ0FBYSxHQUFiLENBQTFELENBQTJFLElBQTNFLENBQUEsQ0FBaUYsSUFBSSxDQUFDLFNBQUwsQ0FBZSxNQUFmLENBQWpGLENBQUEsRUFEVjtTQUpKO09BREo7O1dBT0E7RUF6QkU7O0VBMkJOLE1BQU0sQ0FBQyxPQUFQLEdBQWlCO0FBMUNqQiIsInNvdXJjZXNDb250ZW50IjpbIiMjI1xuIDAwMDAwMDAgIDAwMDAwMDAwICAwMDAwMDAwMDBcbjAwMCAgICAgICAwMDAgICAgICAgICAgMDAwICAgXG4wMDAwMDAwICAgMDAwMDAwMCAgICAgIDAwMCAgIFxuICAgICAwMDAgIDAwMCAgICAgICAgICAwMDAgICBcbjAwMDAwMDAgICAwMDAwMDAwMCAgICAgMDAwICAgXG4jIyNcblxuXyA9IHJlcXVpcmUgJ2xvZGFzaCdcblxuIyMjXG4jIGFjY2VwdHMgYW4gb2JqZWN0LCBhIGtleXBhdGggYXMgYW4gYXJyYXkgb3Igc3RyaW5nIGFuZCBhIHZhbHVlXG4jIHJldHVybnMgdGhlIG9iamVjdCB3aXRoIHZhbHVlIHNldCBhdCBrZXlwYXRoXG4jIyNcblxuc2V0ID0gKG9iamVjdCwga2V5cGF0aCwgdmFsdWUpIC0+XG4gICAgXG4gICAga2V5cGF0aCA9IGtleXBhdGguc3BsaXQgJy4nIGlmIF8uaXNTdHJpbmcga2V5cGF0aFxuICAgIHRocm93IFwiaW52YWxpZCBrZXlwYXRoOiAje0pTT04uc3RyaW5naWZ5IGtleXBhdGh9XCIgaWYgbm90IF8uaXNBcnJheSBrZXlwYXRoXG4gICAgXG4gICAga3AgPSBfLmNsb25lIGtleXBhdGhcbiAgICBvID0gb2JqZWN0XG4gICAgXG4gICAgd2hpbGUga3AubGVuZ3RoID4gMVxuICAgICAgICBrID0ga3Auc2hpZnQoKVxuICAgICAgICBpZiBub3Qgb1trXT9cbiAgICAgICAgICAgIGlmIG5vdCBfLmlzTmFOIF8ucGFyc2VJbnQga1xuICAgICAgICAgICAgICAgIG8gPSBvW2tdID0gW11cbiAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICBvID0gb1trXSA9IHt9XG4gICAgICAgIGVsc2VcbiAgICAgICAgICAgIG8gPSBvW2tdXG4gICAgICAgICAgICBcbiAgICBpZiBrcC5sZW5ndGggPT0gMSBhbmQgbz9cbiAgICAgICAgaWYgdmFsdWUgPT0gdW5kZWZpbmVkXG4gICAgICAgICAgICBkZWxldGUgb1trcFswXV1cbiAgICAgICAgZWxzZVxuICAgICAgICAgICAgb1trcFswXV0gPSB2YWx1ZVxuICAgICAgICAgICAgaWYgb1trcFswXV0gIT0gdmFsdWVcbiAgICAgICAgICAgICAgICB0aHJvdyBcImNvdWxkbid0IHNldCB2YWx1ZSAje0pTT04uc3RyaW5naWZ5IHZhbHVlfSBmb3Iga2V5cGF0aCAje2tleXBhdGguam9pbiAnLid9IGluICN7SlNPTi5zdHJpbmdpZnkgb2JqZWN0fVwiXG4gICAgb2JqZWN0XG5cbm1vZHVsZS5leHBvcnRzID0gc2V0XG4iXX0=
//# sourceURL=C:/Users/kodi/s/sds/coffee/set.coffee